# Utils

## applyPagination

Input: 
- documents: an array of documents
- page: the current page number
- rowsPerPage: the number of rows per page

Output: an array containing a subset of the documents based on the specified page and rows per page

Description: This function is used to apply pagination to an array of documents. It takes in the array of documents, the current page number, and the number of rows per page as input.

The function uses the slice method to extract a subset of the documents array based on the specified page and rows per page. It calculates the starting index by multiplying the page number by the rows per page, and the ending index by adding the starting index to the rows per page.

The function then returns the subset of documents as output. This subset represents the documents that should be displayed on the current page according to the specified pagination settings.

## createEmotionCache

Input: None

Output: Emotion cache object

Description: This function creates an Emotion cache object using the createCache function from the Emotion library. The cache object is used for storing and managing CSS styles generated by Emotion.

The createEmotionCache function takes no input parameters and simply returns the result of calling createCache with a single configuration object. The configuration object has a single property key set to the value 'css'. This key is used by Emotion to identify the cache and associate it with the generated CSS styles.

The returned Emotion cache object can then be used in the application to store and retrieve CSS styles, improving performance by reusing styles instead of generating them repeatedly.

## createResourceId

Input: None

Output: String

Description: This function generates a unique resource ID using the window.crypto.getRandomValues method. 

The createResourceId function does not take any input parameters. It creates a new Uint8Array with a length of 12, which will be used to store random values generated by the window.crypto.getRandomValues method. This method fills the array with cryptographically secure random values.

The function then converts each value in the array to a hexadecimal string using the toString(16) method and pads it with leading zeros using the padStart method to ensure that each string has a length of 2.

Finally, the function uses the Array.from method to convert the array of hexadecimal strings into a regular JavaScript array. The join method is then used to concatenate all the strings in the array into a single string, which represents the generated resource ID.

The function returns this resource ID as the output.

## exportToExcel

Input: { data, fileName }

Output: None

Description: This function exports data to an Excel file in the .xlsx format. It takes an object as input with two properties: data, which is an array of objects representing the data to be exported, and fileName, which is the desired name for the exported file.

The function uses the XLSX.utils.json_to_sheet method from the xlsx library to convert the data array into a worksheet. It then creates a workbook object with a single sheet using the fileName as the sheet name.

The XLSX.write method is used to convert the workbook object into an Excel buffer in the xlsx format. This buffer is then converted into a Blob object with the specified MIME type application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8.

Finally, the FileSaver.saveAs method is called to save the Blob object as a file with the specified fileName and .xlsx file extension.

## importFromExcel

Input: { fileName }

Output: None

Description: This function imports data from an Excel file in the .xlsx format. It takes an object as input with a single property fileName, which is the name of the file to be imported.

The function uses the XLSX.utils.sheet_to_json method from the xlsx library to convert the specified Excel file into a JSON object. It creates a workbook object with a single sheet named 'data' using the imported JSON data.

The XLSX.write method is used to convert the workbook object into an Excel buffer in the xlsx format. This buffer is then converted into a Blob object with the specified MIME type application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8.

Finally, the FileSaver.saveAs method is called to save the Blob object as a file with the specified fileName and .xlsx file extension.

## processExcelCallback

Input: event

Output: Promise <Array<Object>>

Description: This function processes an Excel file that has been selected by the user. It takes an event object as input, which represents the file that was selected.

The function uses the XLSX.read method from the xlsx library to read the contents of the selected file and create a workbook object. It then retrieves the sheet names from the workbook.

If there is at least one sheet in the workbook, the function uses the XLSX.utils.sheet_to_json method to convert the first sheet into a JSON object representing the data in the sheet. This JSON object is returned as the output of the function.

Note: This function assumes that the selected Excel file has only one sheet, and it processes only the first sheet.

# generatePassword

Input: { length }

Output: String

Description: This function generates a random password of the specified length. It takes an object as input with a single property length, which represents the desired length of the password.

The function initializes an empty string result to store the generated password. It then calculates the length of the characters array and iterates length times to generate each character of the password. Each character is randomly selected from the characters array using the Math.random() and Math.floor() functions.

Finally, the generated password is returned as a string.

## getInitials

Input: name (optional)

Output: String

Description: This function extracts the initials from a name. It takes a string name as input, which represents the name from which the initials are to be extracted. If no name is provided, an empty string is used as the default value.

The function first removes any extra whitespace in the name string using the replace method and a regular expression. It then splits the name string into an array of words using the split method and a space as the delimiter. The array is then sliced to contain only the first two words using the slice method.

Each word in the resulting array is mapped to its first character, which is converted to uppercase using the map method and a callback function. The resulting array of initials is then joined into a single string using the join method.

The resulting string of initials is returned.

## notify

Input: obj

Output: None

Description: This function handles notifications and redirects the user if necessary. It takes an object obj as input, which represents the notification message and other properties.

The function checks if the obj.notificationMessage exists and if its action property is equal to "REDIRECT_TO_LOGIN". If both conditions are met, the redirect function is called with the '/auth/login' parameter to redirect the user to the login page.

The openSnackbarExported function is then called with an object containing the notificationMessage, obj.message, and obj.toString() properties. This function is responsible for displaying a snackbar notification with the provided message.